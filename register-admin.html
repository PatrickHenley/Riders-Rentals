<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Registration</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex items-center justify-center min-h-screen bg-gray-50">
  <div class="flex flex-col lg:flex-row w-full max-w-7xl bg-white shadow-lg rounded-xl overflow-hidden m-4">
    <!-- Left Section: Register Form -->
    <div class="w-full lg:w-1/2 p-8 md:p-12 flex flex-col justify-center">
      <h1 class="text-4xl font-bold text-gray-900 mb-2">REGISTER ADMIN</h1>
      <p class="text-gray-600 mb-8">Create a new administrator account.</p>
      <form id="adminRegisterForm" class="space-y-6">
        <div>
          <label for="name" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
          <input type="text" id="name" name="name" required placeholder="Enter full name"
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 text-gray-900 placeholder-gray-400">
        </div>
        <div>
          <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
          <input type="email" id="email" name="email" required placeholder="Enter email"
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 text-gray-900 placeholder-gray-400">
        </div>
        <div>
          <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
          <input type="password" id="password" name="password" required placeholder="Enter password"
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 text-gray-900 placeholder-gray-400">
        </div>
        <div>
          <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label>
          <input type="password" id="confirmPassword" name="confirmPassword" required placeholder="Confirm password"
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 text-gray-900 placeholder-gray-400">
        </div>
        <div id="message" class="text-red-600 text-sm text-center hidden"></div>
        <div id="successMessage" class="text-green-600 text-sm text-center hidden"></div>
        <button type="submit"
                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition duration-150 ease-in-out">
          Register
        </button>
      </form>
      <p class="mt-8 text-center text-sm text-gray-600">
        Already have an account?
        <a href="index.html" class="font-medium text-red-600 hover:text-red-500">Sign in</a>
      </p>
    </div>
    <!-- Right Section: Illustration -->
    <div class="hidden lg:block lg:w-1/2 bg-gray-100 relative">
      <img src="https://res.cloudinary.com/dmbqrwb7c/image/upload/v1754067289/Login_acbx5a.jpg"
           alt="Riders Rentals Register Illustration"
           class="absolute inset-0 w-full h-full object-cover rounded-tr-xl rounded-br-xl"
           onerror="this.onerror=null;this.src='https://placehold.co/700x900/f0f0f0/808080?text=Image+Not+Found';">
    </div>
  </div>

  <script>
    document.getElementById('adminRegisterForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      const message = document.getElementById('message');
      const successMessage = document.getElementById('successMessage');

      // Validation
      if (!name || !email || !password || !confirmPassword) {
        message.textContent = 'All fields are required!';
        message.classList.remove('hidden');
        return;
      }
      if (password !== confirmPassword) {
        message.textContent = 'Passwords do not match!';
        message.classList.remove('hidden');
        return;
      }
      if (password.length < 8) {
        message.textContent = 'Password must be at least 8 characters long!';
        message.classList.remove('hidden');
        return;
      }

      // Prepare data with current timestamp
      const registrationData = {
        name,
        email,
        password,
        registeredAt: new Date('2025-07-28T18:35:00-04:00').toISOString() // 06:35 PM AST, July 28, 2025
      };

      message.classList.add('hidden');
      fetch('http://localhost:3000/api/admins', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(registrationData)
      })
      .then(response => {
        if (!response.ok) {
          return response.text().then(text => { throw new Error(`HTTP ${response.status}: ${text || 'No response body'}`); });
        }
        return response.json();
      })
      .then(data => {
        // On successful registration, redirect to admin.html
        window.location.href = 'admin.html';
      })
      .catch(error => {
        message.textContent = `Error registering admin: ${error.message || 'Please try again'}`;
        message.classList.remove('hidden');
      });
    });
  </script>
</body>
</html>